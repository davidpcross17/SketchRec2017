<!DOCTYPE html>
<html lang="en">
<head>
   <meta charset="UTF-8">
   <title>Project 2</title>
</head>
<body>
   <p>Hello</p>
   <script>

   //used to pop each sketch
    var popped = 0;

    start();

    function start(){
        //Put Json file here!
        //make sure the file is in the same folder as the html file
        //sketch[n].strokes
        var sketchList = readJson("trusses.json");
        //pop sketch

        var sketch = pop(sketchList);
        console.log(sketch);
        //resample sketch
        var resampledSketch = SketchRecTools.resampleByDistance(sketch);
        //find corners
        var corners = findCornersIstraw(sketch);

        //using the corners find the two closests neighbors for each corner
        var NearN, NearstN = Math.pow(2,32) - 1;
        for(var k in corners){
            corner = corners[k];
            dist = SketchRecTools(corner.x,corner.y)
        }

    }
    //Need to keep count of pops of Json
    //This is complex (running time) NEED TO BE FIXED
    function pop(sketchList){
        sketch = sketchList[popped];
        popped = 1;
        return sketch;
    }

    //Parse Data from the Json file
    function readJson(fileName) {
         var contents;
         var xhttp = new XMLHttpRequest();
         xhttp.onreadystatechange = function() {
              if (this.readyState === 4 && this.status === 200) {
                 contents = JSON.parse(this.response);
             }
         };
         xhttp.open("GET", fileName, false);
         xhttp.send();
         return contents;
     }


    /********************************************************/
    //Use the corner finding algorithm to find all the corners in the potential truss
    //Courtesy from 624 Sketch Recognition TA --- PAUL TAELE -----
    //URL: http://people.tamu.edu/~ptaele/csce624/
    /*******************************************************/
    function findCornersIstraw(sketch){
        // get the resampled sketch and its corner indices
        var resampledSketch = SketchRecTools.resampleByDistance(sketch);
        var sketchCornerIndices = IStraw.run(resampledSketch);

        // gather the corners from their indices
        var corners = [];
        for (var i = 0; i < resampledSketch.strokes.length; i++) {
            var resampledPoints = resampledSketch.strokes[i].points;
            var strokeCornerIndices = sketchCornerIndices[i];
            for (var j = 0; j < strokeCornerIndices.length; j++) {
                corners.push(resampledPoints[strokeCornerIndices[j]]);
            }
        }
        return corners;
    }
    /*******************************************************/


   </script>
</body>
</html>
